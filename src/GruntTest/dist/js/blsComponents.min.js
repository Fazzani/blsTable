/*!
 * blsComponents v0.0.13 ()
 * Copyright 2011-2015 Fazzani Heni
 * Licensed under the MIT license
 */
!function(a){a.module("bls_components",["bls_tpls"]).directive("blsTable",["$log","$compile","$templateCache","$timeout","blsTableServices",function(b,c,d,e,f){return this.controller=["$scope","$attrs","$filter","$timeout","$element","$log","localStorageService","blsTableServices",function(b,c,d,e,f,g,h,i){var j=this;j.initialLoad=b.isLoading=!0,this.tableConfig={},b.uniqueId="blsContainer_"+b.$id,b.storageIds={predicateId:"prd_"+b.uniqueId,reverseId:"rvs_"+b.uniqueId,itemsPerPageId:"ipp_"+b.uniqueId,tableConfig:"tblConfig_"+b.uniqueId,colReorderDataKey:"crdKey_"+b.uniqueId,colResizeDataKey:"crsKey_"+b.uniqueId};var k={multiSelection:!0,search:{searchText:"",searchClass:"form-control"},pagination:{pageLength:5,pageIndex:1,pager:{nextTitle:"Suivant",perviousTitle:"Précédent",maxSize:3},itemsPerPage:{prefixStorage:"ipp_",selected:10,range:[10,20]}}};b.options=a.extend({},k,b.options),g.debug("Actions : ",b.options.actions),b.options.pagination.itemsPerPage&&b.options.pagination.itemsPerPage.range&&b.options.pagination.itemsPerPage.range.indexOf(b.options.pagination.pageLength)<1&&(b.options.pagination.pageLength=h.get(b.storageIds.itemsPerPageId)||b.options.pagination.itemsPerPage.range[0]),b.$watch("options.pagination.pageIndex",function(a,c){a!=c&&(b.options.pagination.pageIndex=a++,j.refreshDataGrid())}),b.updateRecordsCount=function(){b.saveUserData({key:b.storageIds.itemsPerPageId,val:b.options.pagination.itemsPerPage.selected}),b.options.pagination.pageLength=b.options.pagination.itemsPerPage.selected,j.refreshDataGrid()},this.refreshDataGrid=function(){a.isDefined(b.funcAsync)&&(j.initColConfig(),b.isLoading=!0,b.reverse=h.get(b.storageIds.reverseId),b.predicate=h.get(b.storageIds.predicateId)||(void 0===b.cols[0]?"":b.cols[0].id),b.funcAsync({pageIndex:b.options.pagination.pageIndex,pageLength:b.options.pagination.itemsPerPage.selected,searchedText:b.options.search.searchText,orderBy:b.predicate,order:b.reverse}))},this.setCols=function(a){b.cols=a,b.$emit("blsDataGrid_initedEvent"),g.debug("cols =>",b.cols),j.initColConfig(),j.refreshDataGrid()},this.changeColumnsOrder=function(a,c){b.$applyAsync(function(){b.data.swap(a,c),b.cols.swap(a,c),j.tableConfig.cols.swap(a,c),b.saveUserData({key:b.storageIds.tableConfig,val:j.tableConfig})})},b.setColWidth=function(a,c){g.debug("setColWidth => ",a," width = ",c),j.tableConfig.cols[a].width=c,b.saveUserData({key:b.storageIds.tableConfig,val:j.tableConfig})},b.$watch("options.search.searchText",function(a,b){j.timerSearch&&e.cancel(j.timerSearch),a!=b&&(j.timerSearch=e(function(){j.refreshDataGrid()},500))}),b.$watch("data",function(a,c){g.debug("data changed!!!"),a!=c&&b.cols.length>0&&(g.debug("init Table config"),j.initTableConfig())}),this.initColConfig=function(){if(h.isSupported&&(j.tableConfig=h.get(b.storageIds.tableConfig)),null===j.tableConfig){j.tableConfig={id:b.uniqueId,cols:[]};for(var a=0;a<=b.cols.length-1;a++)j.tableConfig.cols.push({index:a,width:-1});b.saveUserData({key:b.storageIds.tableConfig,val:j.tableConfig})}},this.initTableConfig=function(){if(j.initialLoad){for(var a=0;a<=j.tableConfig.cols.length-1;a++)if(a!=j.tableConfig.cols[a].index){if(a>j.tableConfig.cols[a].index)continue;g.debug("swap form ",a," to => ",j.tableConfig.cols[a].index),b.data.swap(a,j.tableConfig.cols[a].index),b.cols.swap(a,j.tableConfig.cols[a].index)}j.initialLoad=!1}b.isLoading=!1},b.saveUserData=function(a){h.isSupported&&h.set(a.key,a.val)},b.$on("flushEvent",function(a){g.debug(h.keys()),g.debug("clearUserDataEvent intercepted => $scope.uniqueId : ",b.uniqueId),h.isSupported&&h.clearAll("^(.)+"+b.uniqueId+"$")}),b.$on("refreshEvent",function(a){g.debug("refreshEvent intercepted"),j.refreshDataGrid()}),b.$on("exportEvent",function(a,b){g.debug("exportEvent intercepted to type : ",b),f.find("table").tableExport({type:b})}),b.$on("$destroy",function(a){e.cancel(j.timerSearch)}),b.isHierarchical=function(){return a.isDefined(c.getChildren)}}],{restrict:"E",replace:!0,transclude:!0,templateUrl:"templates/blsTable.html",controller:this.controller,scope:{data:"=ngModel",funcAsync:"&",getChildren:"&",options:"=",totalItems:"="}}}])}(window.angular),angular.module("bls_components").directive("allowDrag",function(){return{restrict:"A",require:["^blsTable"],compile:function(a,b){function c(a,b){var c=a[0].parentNode.querySelector("."+b);c&&c.classList.remove(b)}return function(a,b,d,e){var f=e[0];b.attr("draggable",!0),b.bind("dragstart",function(a){f.target=this,this.classList.add("dragged"),a.originalEvent.dataTransfer.setData("text",f.target.cellIndex)}),b.bind("dragover",function(a){a.preventDefault()}),b.bind("dragenter",function(a){f.toTarget=this,this.classList.contains("draggedOver")||this.classList.contains("dragged")||this.classList.add("draggedOver"),a.preventDefault(),a.stopPropagation()}),b.bind("dragend",function(a){this.classList.contains("dragged")&&this.classList.remove("dragged"),a.preventDefault()}),b.bind("dragleave",function(a){this.classList.remove("draggedOver")}),b.bind("drop",function(a){var d=f.toTarget.cellIndex,e=parseInt(a.originalEvent.dataTransfer.getData("text"),10);c(b,"dragged"),c(b,"draggedOver"),f.changeColumnsOrder(d,e),a.preventDefault()})}}}}),angular.module("bls_components").directive("blsActions",["$log","$compile","$templateCache","$timeout","$q",function(a,b,c,d,e){var f=function(a,f,g,h){if(a.c.isActions){var i=angular.element(c.get("templates/blsActions.html"));d(function(){f.replaceWith(i),b(i)(a)},0)}a.action=function(b,c){e.when(b.action(c)).then(function(d){b.isRemoveAction&&a.data.splice(a.data.indexOf(c),1)})}};return{priority:-18,restrict:"A",link:f}}]),angular.module("bls_components").directive("blsCol",["$log","$compile","$templateCache","$timeout",function(a,b,c,d){var e={pre:function(b,c,d,e){var f=e[1];a.debug("        Link => blsCol"),d.isActions?f.addCol({title:d.title||"Actions",isActions:!0,resize:angular.isDefined(d.resize)}):f.addCol({title:d.title||d.fieldName,fieldName:d.fieldName,resize:angular.isDefined(d.resize),tpl:c.html(),sortable:angular.isDefined(d.sort),dragable:angular.isDefined(d.dragable)})}};return{priority:-1,require:["^blsTable","^blsCols","blsCol"],restrict:"E",link:e}}]),angular.module("bls_components").directive("blsCols",["$log","$compile","$templateCache","$timeout",function(a,b,c,d){var e={post:function(b,c,d,e){var f=e[0],g=e[1];a.debug("    Link => blsCols"),f.setCols(g.getCols())}},f=["$scope","$filter","$timeout","$element","$log","localStorageService","blsTableServices",function(a,b,c,d,e,f,g){e.debug("    controller => blsCols");var h=[];this.addCol=function(a){h.push(a)},this.getCols=function(){return h}}];return{priority:0,require:["^blsTable","blsCols"],restrict:"E",link:e,controller:f}}]),angular.module("bls_components").directive("blsDropDown",[function(){return{templateUrl:"templates/blsDropDown.html",replace:!0,scope:{links:"=",title:"=",func:"&"}}}]),angular.module("bls_components").directive("blsHeader",["$log","$compile","$templateCache","$timeout","localStorageService",function(a,b,c,d,e){var f={pre:function(f,g,h,i){f.$on("blsDataGrid_initedEvent",function(h){a.debug("    blsDataGrid_initedEvent intercepted");var j=i[0];i[1];f.setPredicate(e.get(f.storageIds.predicateId)||(void 0===f.cols[0]?"":f.cols[0].id)),f.refreshDataGrid=j.refreshDataGrid,a.debug("    Link => blsHeader");var k=angular.element(c.get("templates/blsHeader.html"));f.getColWidth=function(a){return j.tableConfig.cols[a].width>0?j.tableConfig.cols[a].width+"px":void 0},d(function(){g.siblings("table").find("thead").append(k),a.debug("    compiling blsHeader"),b(k)(f)},0)})}},g=["$scope","$filter","$timeout","$element","$log","localStorageService","blsTableServices",function(a,b,c,d,e,f,g){function h(a){i.resizePressed&&(start.width=startWidth+(a.pageX-startX),i.resizeColData={index:angular.element(a.target).scope().$index,width:start.width})}var i=this;i.reverse=f.get(a.storageIds.reverseId)||i.reverse,i.resizeColData=null,i.resizePressed=!1,e.debug("    blsHeader controller: in init..."),a.setPredicate=function(a){i.predicate=a},a.glyphOrder=function(b){return e.debug("    glyphOrder function was called"),b.fieldName!=a.predicate?"fa-sort":i.reverse?"fa-sort-asc":"fa-sort-desc"},a.order=function(b){i.resizePressed||b.sortable&&(e.debug("    order function was called"),i.reverse=a.predicate===b.fieldName?!i.reverse:!1,i.predicate=b.fieldName,a.saveUserData({key:a.storageIds.predicateId,val:i.predicate}),a.saveUserData({key:a.storageIds.reverseId,val:i.reverse}),a.refreshDataGrid())},a.resizeStart=function(b){var c=b.target?b.target:b.srcElement;c.classList.contains("resize")&&(start=c.parentNode,i.resizePressed=!0,startX=b.pageX,startWidth=c.parentNode.offsetWidth,document.addEventListener("mousemove",h),document.addEventListener("mouseup",a.resizeEnd),b.stopPropagation(),b.preventDefault())},a.resizeEnd=function(b){return i.resizePressed?(document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",a.resizeEnd),b.stopPropagation(),b.preventDefault(),setTimeout(function(){i.resizePressed=!1},50),a.setColWidth(i.resizeColData.index,i.resizeColData.width),i.resizeColData=null,!1):void 0}}];return{priority:-20,require:["^?blsTable","blsHeader"],restrict:"E",link:f,controller:g}}]),angular.module("bls_components").directive("blsRowChild",["$log","$compile","$templateCache","$timeout",function(a,b,c,d){var e=function(e,f,g,h,i){a.debug("    Link => blsRows");var j=this;this.childs=[];var k=angular.element(c.get("templates/blsChildRowsCaret.html"));e.expand=!1,e.firstExpand=!0,this.getRowsChilds=function(a,b){var c=b.siblings('tr[parentId="'+a+'"]').toArray();j.childs=j.childs.concat(c);for(var d=0;d<c.length;d++)j.childs.concat(getRowsChilds(angular.element(c[d]).data("blsId"),$(c[d])));return j.childs},e.getTdTpl=function(a,b){return a.tpl&&""!==a.tpl?(a.tpl=a.tpl.replace("::data","d"),a.tpl.replace("::field","d[c.fieldName]")):void 0};var l=angular.element(c.get("templates/blsChildRows.html"));angular.isDefined(g.level)||(e.level=0,f.data("dataLevel",e.level)),d(function(){this.toggle=function(a,b,c){j.childs=j.getRowsChilds(a,b),j.childs.forEach(function(a){c?$(a).show():$(a).hide()})},k.on("click",function(c){a.debug("    toggle row");var d=$(this);if(e.firstExpand){k.addClass("fa-spinner"),e.firstExpand=!1;var g=e.$new();e.getChildren()(e.d).then(function(a){k.removeClass("fa-spinner"),a.data.length>0?(g.data=a.data,g.level=e.level+1,g.parentId=e.$id,b(l)(g),e.expand=!e.expand,j.toggle(e.$id,d.closest("tr"),e.expand),l.insertAfter(f)):k.removeClass("fa").removeClass("fa-caret-down").removeClass("fa-caret-right").off("click")})}else e.$apply(function(){e.expand=!e.expand,j.toggle(e.$id,d.closest("tr"),e.expand)})}),b(k)(e),angular.element(f.find("td")[0]).prepend(k)},0)};return{require:["^blsTable"],priority:-16,restrict:"A",link:e,scope:!0}}]),angular.module("bls_components").directive("blsRows",["$log","$compile","$templateCache","$timeout",function(a,b,c,d){var e=function(a,e,f,g){var h=angular.element(c.get("templates/blsRows.html"));a.isHierarchical()&&h.attr("bls-row-child",""),d(function(){e.siblings("table").find("tbody").append(h),b(h)(a)},0)};return{require:["^blsTable"],priority:-17,restrict:"E",link:e,scope:!0}}]),angular.module("bls_components").directive("blsToolBar",[function(){return{priority:2,scope:!0,restrict:"E",templateUrl:"templates/blsToolBar.html",replace:!0,controller:["$scope","$element","$document","$log",function(a,b,c,d){a.btnClass="btn btn-default",a.searchPlaceHolder="search...",a.selectedAll=!1,a.titleExportButton="Export",a.clearUserData=function(){a.$emit("flushEvent")},a.refresh=function(){a.$emit("refreshEvent")},a.toggleSelectAll=function(){a.selectedAll=!a.selectedAll,a.$emit("toggleSelectAllEvent",a.selectedAll)},a["export"]=function(b){d.debug("    export type => ",b),a.$emit("exportEvent",b)},a.links=["excel","xml","csv","sql","json","doc","powerpoint"]}]}}]),angular.module("bls_components").directive("blsTr",["$compile","$templateRequest","$templateCache","$log",function(a,b,c,d){var e={post:function(b,e,f,g){g[1],g[0];angular.isDefined(b.row)||(b.row=b.$eval(f.blsTr)),angular.isDefined(b.columns)||(b.columns=b.$parent.$parent.columns),angular.isDefined(b.config)||(b.config=b.$eval(f.config)),angular.isDefined(b.nestedDataFunc)||(b.nestedDataFunc=b.$eval(f.nestedDataFunc)),angular.isDefined(b.index)||(b.index=b.$eval(f.index)),b.config?(b.config.level++,b.childConfig={level:b.config.level+1,collapsed:!0,loaded:!1}):b.config={level:0,collapsed:!0,loaded:!1},d.debug("config  ===== ",b.config),d.debug("**************************  start compile blsTr"),b.tpl=angular.element(c.get("templates/blsTr.html")),e.replaceWith(b.tpl),a(b.tpl)(b)}};return{restrict:"A",require:["^?blsNestedGrid","blsTr"],link:e,scope:{},controller:["$scope","$element","$attrs","$log","$compile","$templateCache",function(a,b,c,d,e,f){d.debug("row = ",a.row),a.expand=function(){d.debug("expanding data"),a.config.collapsed=!a.config.collapsed,a.config.loaded||(a.config.loaded=!0,a.nestedDataFunc()(a.row).then(function(c){angular.isArray(c.data)||(c.data=[c.data]),angular.forEach(c.data,function(f,g){var h=a.$new(!0);h.nestedDataFunc=a.nestedDataFunc(),h.columns=a.columns,h.row=f,h.index=a.index+1,h.config={level:a.config.level+1,collapsed:!0,loaded:!1},e(a.tpl)(h),a.tpl.insertAfter(b),d.debug("childs length : ",c.data)}),a.$parent.data.splice(a.index+1,0,c.data)}))},a.collpaseState=function(a){return angular.isDefined(a)?a.collapsed?"fa-caret-right":"fa-caret-down":void 0}}]}}]),angular.module("bls_components").directive("draggable",function(){return{link:function(a,b,c){b.attr("draggable",!0);var d="",e="";c.$observe("dragdata",function(a){d=a}),c.$observe("dragimage",function(a){e=a}),b.bind("dragstart",function(b){var e=angular.toJson(d);b.originalEvent.dataTransfer.setData("Text",e);var f=c.drag;"undefined"!==f&&a.$apply(function(){a[f](e)})})}}}),angular.module("bls_components").directive("droppable",["$parse",function(a){return{link:function(b,c,d){function e(a){return console.log("drag over"),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.originalEvent.dataTransfer.dropEffect="move",!1}function f(c){console.log("onDrop"),c.preventDefault&&c.preventDefault(),c.stopPropagation&&c.stopPropagation();var e=c.originalEvent.dataTransfer.getData("Text");e=angular.fromJson(e);var f=d.drop;a(d.drop);b.$apply(function(){b[f](e,c.target)})}c.bind("dragover",e),c.bind("drop",f)}}}]),angular.module("bls_components").directive("dynamic",["$compile",function(a){return{restrict:"A",replace:!0,link:function(b,c,d){b.$watch(d.dynamic,function(d){c.html(d),a(c.contents())(b)})}}}]),angular.module("bls_components").directive("panel",function(){return{link:function(a,b,c){a.dataSource="directive"},restrict:"E",scope:!0,template:function(){return angular.element(document.querySelector("#template")).html()},transclude:!0}}),angular.module("bls_components").service("blsTableServices",["$log","localStorageService",function(a,b){Array.prototype.swap=function(a,b){if(a>=this.length)for(var c=a-this.length;c--+1;)this.push(void 0);return this.splice(a,0,this.splice(b,1)[0]),this},this.defaultColConfig=function(a){for(var b=new Array(a),c=b.length-1;c>=0;c--)b[c]=c;return b},this.swapArrayElements=function(a,b,c){var d=a[b];a[b]=a[c],a[c]=d},this.initReorderColumns=function(a,c,d){var e=b.get(d);(null===e||0===e.length)&&(e=this.defaultColConfig(a.length));for(var f=this,g=0;g<e.length-2;g++)if(g!=e[g]){if(g>e[g]&&g==e[e.indexOf(g)])continue;f.swapArrayElements(a,g,e.indexOf(g)),f.swapArrayElements(c,g,e.indexOf(g))}return e},this.saveConfig=function(c,d){b.isSupported&&(a.info("saveConfig  : "+d),a.info("saveConfig key : "+c),b.set(c,d))}}]),function(a){a.fn.extend({tableExport:function(b){function c(a){return"true"==d.htmlContent?content_data=a.html().trim():content_data=a.text().trim(),"true"==d.escape&&(content_data=escape(content_data)),content_data}var d={separator:",",ignoreColumn:[],tableName:"yourTableName",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false"},b=a.extend(d,b),e=this;if("csv"==d.type||"txt"==d.type){var f="";a(e).find("thead").find("tr").each(function(){f+="\n",a(this).filter(":visible").find("th").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+='"'+c(a(this))+'"'+d.separator)}),f=a.trim(f),f=a.trim(f).substring(0,f.length-1)}),a(e).find("tbody").find("tr").each(function(){f+="\n",a(this).filter(":visible").find("td").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+='"'+c(a(this))+'"'+d.separator)}),f=a.trim(f).substring(0,f.length-1)}),"true"==d.consoleLog&&console.log(f);var g="base64,"+a.base64.encode(f);window.open("data:application/"+d.type+";filename=exportData;"+g)}else if("sql"==d.type){var f="INSERT INTO `"+d.tableName+"` (";a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+="`"+c(a(this))+"`,")}),f=a.trim(f),f=a.trim(f).substring(0,f.length-1)}),f+=") VALUES ",a(e).find("tbody").find("tr").each(function(){f+="(",a(this).filter(":visible").find("td").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+='"'+c(a(this))+'",')}),f=a.trim(f).substring(0,f.length-1),f+="),"}),f=a.trim(f).substring(0,f.length-1),f+=";","true"==d.consoleLog&&console.log(f);var g="base64,"+a.base64.encode(f);window.open("data:application/sql;filename=exportData;"+g)}else if("json"==d.type){var h=[];a(e).find("thead").find("tr").each(function(){var b=[];a(this).filter(":visible").find("th").each(function(e,f){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&b.push(c(a(this)))}),h.push(b)});var i=[];a(e).find("tbody").find("tr").each(function(){var b=[];a(this).filter(":visible").find("td").each(function(e,f){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&b.push(c(a(this)))}),i.push(b)});var j=[];j.push({header:h,data:i}),"true"==d.consoleLog&&console.log(JSON.stringify(j));var g="base64,"+a.base64.encode(JSON.stringify(j));window.open("data:application/json;filename=exportData;"+g)}else if("xml"==d.type){var k='<?xml version="1.0" encoding="utf-8"?>';k+="<tabledata><fields>",a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(k+="<field>"+c(a(this))+"</field>")})}),k+="</fields><data>";var l=1;a(e).find("tbody").find("tr").each(function(){k+='<row id="'+l+'">';var b=0;a(this).filter(":visible").find("td").each(function(e,f){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&(k+="<column-"+b+">"+c(a(this))+"</column-"+b+">"),b++}),l++,k+="</row>"}),k+="</data></tabledata>","true"==d.consoleLog&&console.log(k);var g="base64,"+a.base64.encode(k);window.open("data:application/xml;filename=exportData;"+g)}else if("excel"==d.type||"doc"==d.type||"powerpoint"==d.type){var m="<table>";a(e).find("thead").find("tr").each(function(){m+="<tr>",a(this).filter(":visible").find("th").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(m+="<td>"+c(a(this))+"</td>")}),m+="</tr>"});var l=1;a(e).find("tbody").find("tr").each(function(){m+="<tr>";var b=0;a(this).filter(":visible").find("td").each(function(e,f){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&(m+="<td>"+c(a(this))+"</td>"),b++}),l++,m+="</tr>"}),m+="</table>","true"==d.consoleLog&&console.log(m);var n="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+d.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";n+="<head>",n+="<!--[if gte mso 9]>",n+="<xml>",n+="<x:ExcelWorkbook>",n+="<x:ExcelWorksheets>",n+="<x:ExcelWorksheet>",n+="<x:Name>",n+="{worksheet}",n+="</x:Name>",n+="<x:WorksheetOptions>",n+="<x:DisplayGridlines/>",n+="</x:WorksheetOptions>",n+="</x:ExcelWorksheet>",n+="</x:ExcelWorksheets>",n+="</x:ExcelWorkbook>",n+="</xml>",n+="<![endif]-->",n+="</head>",n+="<body>",n+=m,n+="</body>",n+="</html>";var g="base64,"+a.base64.encode(n);window.open("data:application/vnd.ms-"+d.type+";filename=exportData.doc;"+g)}else if("png"==d.type)html2canvas(a(e),{onrendered:function(a){var b=a.toDataURL("image/png");window.open(b)}});else if("pdf"==d.type){var o=new jsPDF("p","pt","a4",!0);o.setFontSize(d.pdfFontSize);var p=d.pdfLeftMargin;a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b,e){if("none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)){var f=p+50*b;o.text(f,20,c(a(this)))}})});var q=20,r=1,s=0;a(e).find("tbody").find("tr").each(function(b,e){rowCalc=b+1,rowCalc%26==0&&(o.addPage(),r++,q+=10),s=q+10*rowCalc-280*(r-1),a(this).filter(":visible").find("td").each(function(b,e){if("none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)){var f=p+50*b;o.text(f,s,c(a(this)))}})}),o.output("datauri")}}})}(jQuery),jQuery.base64=function(a){function b(a,b){var c=g.indexOf(a.charAt(b));if(-1===c)throw"Cannot decode base64";return c}function c(a){var c,d,e=0,g=a.length,h=[];if(a=String(a),0===g)return a;if(g%4!==0)throw"Cannot decode base64";for(a.charAt(g-1)===f&&(e=1,a.charAt(g-2)===f&&(e=2),g-=4),c=0;g>c;c+=4)d=b(a,c)<<18|b(a,c+1)<<12|b(a,c+2)<<6|b(a,c+3),h.push(String.fromCharCode(d>>16,d>>8&255,255&d));switch(e){case 1:d=b(a,c)<<18|b(a,c+1)<<12|b(a,c+2)<<6,h.push(String.fromCharCode(d>>16,d>>8&255));break;case 2:d=b(a,c)<<18|b(a,c+1)<<12,h.push(String.fromCharCode(d>>16))}return h.join("")}function d(a,b){var c=a.charCodeAt(b);if(c>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return c}function e(a){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";a=String(a);var b,c,e=[],h=a.length-a.length%3;if(0===a.length)return a;for(b=0;h>b;b+=3)c=d(a,b)<<16|d(a,b+1)<<8|d(a,b+2),e.push(g.charAt(c>>18)),e.push(g.charAt(c>>12&63)),e.push(g.charAt(c>>6&63)),e.push(g.charAt(63&c));switch(a.length-h){case 1:c=d(a,b)<<16,e.push(g.charAt(c>>18)+g.charAt(c>>12&63)+f+f);break;case 2:c=d(a,b)<<16|d(a,b+1)<<8,e.push(g.charAt(c>>18)+g.charAt(c>>12&63)+g.charAt(c>>6&63)+f)}return e.join("")}var f="=",g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="1.0";return{decode:c,encode:e,VERSION:h}}(jQuery);