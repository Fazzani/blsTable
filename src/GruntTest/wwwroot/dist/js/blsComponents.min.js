/*!
 * blsComponents v0.0.50 ()
 * Copyright 2011-2015 Fazzani Heni
 * Licensed under the MIT license
 */

!function(a){"use strict";a.module("bls_tpls",[]).run(["$templateCache","$templateRequest",function(a,b){a.put("templates/blsTable.html",'<div class="bls-table-container">            <div ng-class="{\'overlay\':isLoading}"><div ng-show="isLoading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div></div>            <bls-tool-bar ng-hide="options.toolbar.hide"></bls-tool-bar>            <table class="table table-hover table-striped table-bordered blsGrid">                <thead ng-mousedown="resizeStart($event)" ng-mouseup="resizeEnd($event)">                    <bls-header></bls-header>                </thead>                <tbody>                    <bls-rows></bls-rows>                </tbody>            </table>            <div style="display:none" id="colsConfig" ng-transclude></div>            <div class="footer">                <pagination class="col-md-10 col-xs-8" total-items="totalItems" ng-model="options.pagination.pageIndex" max-size="options.pagination.pager.maxSize" items-per-page="options.pagination.itemsPerPage.selected" class="pagination-sm" boundary-links="true" rotate="false"></pagination>                <div class="pagerList col-md-2 col-xs-4">                    <select class="form-control" id="sel1" ng-model="options.pagination.itemsPerPage.selected" ng-change="updateRecordsCount()" ng-options="c as c for c in options.pagination.itemsPerPage.range" ng-selected="options.pagination.itemsPerPage.selected == c"></select>                </div>            </div>        </div>'),a.put("templates/blsDropDown.html",'<div class="dropdown">                  <button class="btn btn-default btn-sm dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">                    {{title}}                    <span class="caret"></span>                  </button>                  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1" >                    <li ng-repeat="link in links"><a ng-click="func()(link)">{{link}}</a></li>                  </ul>             </div>'),a.put("templates/blsToolBar.html",'<div class="row">                       <div class="btn-toolbar pull-right col-xs-12" role="toolbar">                            <div class="btn-group btn-group-sm pull-right ">                                <bls-drop-down links="options.toolbar.export.formats" func="export" title="titleExportButton" ng-hide="options.toolbar.export.hide"></bls-drop-down>                                <button type="button" ng-click="clearUserData()" ng-hide="options.toolbar.reset.hide" class="{{btnClass}}" tooltip="Reset" aria-label="Right Align"><span class="fa fa-recycle" aria-hidden="true"></span></button>                                <button type="button" ng-click="refresh()" ng-hide="options.toolbar.refresh.hide" class="{{btnClass}}" tooltip="Refresh" aria-label="Right Align"><span class="fa fa-refresh" aria-hidden="true"></span></button>                            </div>                            <form action="" class="search-form pull-right col-md-2 col-xs-12" ng-hide="options.toolbar.search.hide">                                <div class="form-group has-feedback">                                    <label for="search" class="sr-only">Search</label>                                    <input type="text" class="{{options.toolbar.search.searchClass}}" name="search" id="search" placeholder="{{searchPlaceHolder}}" ng-model="options.toolbar.search.searchedText">                                    <span class="glyphicon glyphicon-search form-control-feedback"></span>                                </div>                            </form>                        </div>                 </div>'),a.put("templates/blsSearchBox.html",'<div class="col-xs-6 col-md-3 navbar-btn form-group navbar-form">					    <input type="text" class="form-control" placeholder="{{options.placeholder}}" ng-model="model">					    <button  ng-show="model==\'\'" type="submit" class="btn btn-search"><i class="fa fa-search"></i></button>                        <span ng-show="model" ng-click="model=null" class="glyphicon glyphicon-remove-sign form-control-feedback form-control-clear" aria-hidden="true"></span>                        <span class="sr-only">Clear input content</span>				   </div>'),a.put("templates/blsHeader.html",'<tr>                        <th class="colHeader" ng-class="glyphOrder(c)" ng-repeat="c in cols" ng-click="order(c)" style="width:{{getColWidth($index)}}" allow-drag>                            <span ng-if="c.headerTpl!==undefined" ng-bind-html="c.headerTpl" ng-init="getTdTpl(c)" dynamic="c.headerTpl"></span>                            <span ng-if="c.headerTpl===undefined" ng-bind="c.title|uppercase"></span>                            <i ng-if="c.resize" class="resize"></i>                        </th>                   </tr>'),a.put("templates/blsRows.html",'<tr ng-repeat="d in data">                 <td ng-repeat="c in cols" ng-init="getTdTpl(c)" dynamic="c.tpl" ng-bind-html="d[c.fieldName]| highlight:options.toolbar.search.searchedText:options.toolbar.search.heighLight"></td>            </tr>'),a.put("templates/blsChildRows.html",'<tr ng-repeat="d in data" data-bls-id="{{$id}}" parentId="{{parentId}}" bls-row-child func="getChildren" data-level="{{level}}">                            <td ng-repeat="c in cols" ng-init="getTdTpl(c)" dynamic="c.tpl" ng-bind-html="d[c.fieldName]| highlight:options.toolbar.search.searchedText:options.toolbar.search.heighLight"></td></tr>'),a.put("templates/blsStaticChildRows.html",'<tr ng-repeat="d in data" data-bls-id="{{$id}}" parentId="{{parentId}}" bls-static-child-cells level="{{level}}"></tr>'),a.put("templates/blsStaticChildCells.html",'<td ng-repeat="c in cols" ng-init="getTdTpl(c)" dynamic="c.tpl">                                    <i id="{{$id}}" ng-if="isExpandable" class="fa {{expand?\'fa-caret-down\':\'fa-caret-right\'}}" style="padding:0 4px 0 {{5+(15*level)}}px"></i>                                    {{ngModel[c.fieldName]}}{{isExpandable}}</td>                                <bls-static-childs-rows ng-model="childs" ng-if="isExpandable"  level={{level++}}></bls-static-childs-rows>'),a.put("templates/blsChildRowsCaret.html",'<i id="{{$id}}" class="fa {{expand?\'fa-caret-down\':\'fa-caret-right\'}}" style="padding:0 4px 0 {{5+(15*level)}}px"></i>')}])}(window.angular),function(a){a.module("bls_components",["bls_tpls","ngSanitize"]).directive("blsTable",["$log","$compile","$templateCache","$timeout","$parse","blsTableServices",function(b,c,d,e,f,g){var h=0;return this.controller=["$scope","$attrs","$filter","$timeout","$element","$log","localStorageService","blsTableServices","blsTableConfigManager",function(b,c,d,e,f,g,i,j,k){var l=this;l.initialLoad=b.isLoading=!0,b.uniqueId="blsContainer_"+(a.isDefined(c.id)?c.id:h++),this.tableConfigManager=new k(b.uniqueId);var m={multiSelection:!0,callbacks:[],toolbar:{hide:!1,search:{hide:!1,searchedText:"",searchClass:"form-control",heighLight:!0,minChars:{enabled:!0,count:3}},"export":{hide:!1,formats:["excel","xml","csv","sql","json"]},reset:{hide:!1},refresh:{hide:!1}},pagination:{pageLength:5,pageIndex:1,pager:{nextTitle:"Suivant",perviousTitle:"Précédent",maxSize:3},itemsPerPage:{prefixStorage:"ipp_",selected:10,range:[10,20]}}};this.initOptions=function(){l.initOptionsArray=function(){try{a.isDefined(b.options.toolbar["export"].formats)&&(m.toolbar["export"].formats=b.options.toolbar["export"].formats)}catch(c){}try{a.isDefined(b.options.pagination.itemsPerPage.range)&&(m.pagination.itemsPerPage.range=b.options.pagination.itemsPerPage.range)}catch(c){}},l.initOptionsArray();var c=a.copy(b.options);a.merge(b.options,m),a.merge(b.options,c),b.options.toolbar["export"].formats=b.options.toolbar["export"].formats.distinct(),b.options.pagination.itemsPerPage.range=b.options.pagination.itemsPerPage.range.distinct()},b.$watch("options.pagination.pageIndex",function(a,c){a!=c&&(b.options.pagination.pageIndex=a++,l.refreshDataGrid())}),b.updateRecordsCount=function(){l.tableConfigManager.saveItemsByPage(b.options.pagination.itemsPerPage.selected),b.options.pagination.pageLength=b.options.pagination.itemsPerPage.selected,l.refreshDataGrid()},this.refreshDataGrid=function(){a.isDefined(b.funcAsync)&&(l.tableConfigManager.init(b.cols,f[0].offsetWidth),b.options.pagination.itemsPerPage.selected=l.tableConfigManager.get().itemsByPage||b.options.pagination.itemsPerPage.range[0],b.isLoading=!0,b.funcAsync({pageIndex:b.options.pagination.pageIndex,pageLength:b.options.pagination.itemsPerPage.selected,searchedText:b.options.toolbar.search.searchedText,sortTable:l.tableConfigManager.listSortedCols()}))},this.setCols=function(a){b.cols=a,b.$emit("blsDataGrid_initedEvent"),l.tableConfigManager.init(b.cols,f[0].offsetWidth),l.refreshDataGrid()},this.getCols=function(){return b.cols},b.setSortDirection=function(a,b){l.tableConfigManager.setSortDirection(a,b)},this.changeColumnsOrder=function(a,c){b.$applyAsync(function(){b.data.swap(a,c),b.cols.swap(a,c),l.tableConfigManager.swapCol(a,c)}),l.refreshDataGrid()},b.setColWidth=function(a,b){l.tableConfigManager.setColWidth(a,b)},b.$watch("options.toolbar.search.searchedText",function(a,b){l.timerSearch&&e.cancel(l.timerSearch),a!=b&&(l.timerSearch=e(function(){l.refreshDataGrid()},500))}),b.$watch("data",function(a,c){a!=c&&b.cols.length>0&&l.initFromTableConfig()}),this.initFromTableConfig=function(){if(l.initialLoad){for(var a=0;a<=l.tableConfigManager.get().cols.length-1;a++)if(a!=l.tableConfigManager.get().cols[a].index){if(a>l.tableConfigManager.get().cols[a].index)continue;b.data.swap(a,l.tableConfigManager.get().cols[a].index),b.cols.swap(a,l.tableConfigManager.get().cols[a].index)}l.initialLoad=!1}b.isLoading=!1},this.getChildItemsProp=function(){return b.childItemsProp},b.isStaticHierarchic=function(){return a.isDefined(b.childItemsProp)&&b.childItemsProp.length>0},b.$on("blsTable.ResetEvent",function(a){g.debug("clearUserDataEvent intercepted => $scope.uniqueId : ",b.uniqueId),l.tableConfigManager.destroy()}),b.$on("blsTable.RefreshEvent",function(a){l.refreshDataGrid()}),b.$on("blsTable.ExportEvent",function(a,b){f.find("table").tableExport({type:b})}),b.$on("$destroy",function(a){e.cancel(l.timerSearch)}),b.isHierarchical=function(){return a.isDefined(c.getChildren)},this.initOptions()}],{restrict:"E",replace:!0,transclude:!0,templateUrl:"templates/blsTable.html",controller:this.controller,scope:{data:"=ngModel",funcAsync:"&",getChildren:"&",options:"=",totalItems:"=",childItemsProp:"@"}}}])}(window.angular),angular.module("bls_components").directive("allowDrag",function(){return{restrict:"A",require:["^blsTable"],compile:function(a,b){function c(a,b){var c=a[0].parentNode.querySelector("."+b);c&&c.classList.remove(b)}return function(a,b,d,e){var f=e[0];b.attr("draggable",!0),b.bind("dragstart",function(a){f.target=this,this.classList.add("dragged"),a.originalEvent.dataTransfer.setData("text",f.target.cellIndex)}),b.bind("dragover",function(a){a.preventDefault()}),b.bind("dragenter",function(a){f.toTarget=this,this.classList.contains("draggedOver")||this.classList.contains("dragged")||this.classList.add("draggedOver"),a.preventDefault(),a.stopPropagation()}),b.bind("dragend",function(a){this.classList.contains("dragged")&&this.classList.remove("dragged"),a.preventDefault()}),b.bind("dragleave",function(a){this.classList.remove("draggedOver")}),b.bind("drop",function(a){var d=f.toTarget.cellIndex,e=parseInt(a.originalEvent.dataTransfer.getData("text"),10);c(b,"dragged"),c(b,"draggedOver"),f.changeColumnsOrder(d,e),a.preventDefault()})}}}}),angular.module("bls_components").directive("blsCol",["$log","$timeout",function(a,b){var c=[],d=function(a,b,d,e){var f=e[1];this.getTemplates=function(){var a=c[d.fieldName];if(""===a||a.startsWith("{{"))return a.startsWith("{{")?{headerTpl:void 0,tdTpl:a}:{headerTpl:void 0,tdTpl:void 0};var b=$("<div></div>").wrapInner(a),e=b.find("header");return{headerTpl:e.length?e.html():void 0,tdTpl:e.length?b.find("bls-td").html():b.html()}};var g=this.getTemplates();f.addCol({title:d.title||d.fieldName,fieldName:d.fieldName,resize:angular.isDefined(d.resize),tpl:g.tdTpl,headerTpl:g.headerTpl,sortable:angular.isDefined(d.sort),dragable:angular.isDefined(d.dragable)})};return{priority:-1,require:["^blsTable","^blsCols"],restrict:"E",compile:function(a,b,e){return c[b.fieldName]=a.html(),a.empty(),{pre:d}}}}]),angular.module("bls_components").directive("blsCols",["$log","$compile","$templateCache","$timeout",function(a,b,c,d){var e={post:function(a,b,c,d){var e=d[0],f=d[1];e.setCols(f.getCols())}},f=["$scope","$filter","$timeout","$element","$log","localStorageService","blsTableServices",function(a,b,c,d,e,f,g){var h=[];this.addCol=function(a){h.push(a)},this.getCols=function(){return h}}];return{priority:0,require:["^blsTable","blsCols"],restrict:"E",link:e,controller:f}}]),angular.module("bls_components").directive("blsDropDown",[function(){return{templateUrl:"templates/blsDropDown.html",replace:!0,scope:{links:"=",title:"=",func:"&"}}}]),angular.module("bls_components").directive("blsHeader",["$log","$compile","$templateCache","$timeout","localStorageService",function(a,b,c,d,e){var f={asc:"asc",desc:"desc"},g={pre:function(a,e,f,g){a.$on("blsDataGrid_initedEvent",function(f){var h=g[0];g[1];a.refreshDataGrid=h.refreshDataGrid;var i=angular.element(c.get("templates/blsHeader.html"));a.getColWidth=function(a){return h.tableConfigManager.get().cols[a].width>0?h.tableConfigManager.get().cols[a].width+"px":void 0},a.getColConfig=function(a){return h.tableConfigManager.get().cols.filter(function(b,c){return b.fieldName===a?!0:void 0})[0]},a.getColConfigIndex=function(b){var c=a.getColConfig(b);return c?h.tableConfigManager.get().cols.indexOf(c):null},a.glyphOrder=function(b){if(!b.sortable)return"";var c=a.getColConfig(b.fieldName);return c.sortDirection?"fa-sort"+("none"==c.sortDirection?"":"-"+c.sortDirection):"fa-sort"},d(function(){e.siblings("table").find("thead").append(i),b(i)(a)},0)})}},h=["$scope","$filter","$timeout","$element","$log","localStorageService","blsTableServices",function(a,b,c,d,e,g,h){function i(a){var b=$(j.resizeData.siblingTarget),c=$(j.resizeData.target),d=a.pageX-j.resizeData.startX,e=j.resizeData.startWidth+d;j.resizeData.resizePressed&&j.resizeData.maxWidth>e&&j.resizeData.minWidth<e&&(c.width(e),b.width(j.resizeData.startWidthSibling-d),j.resizeColData={index:j.resizeData.target.cellIndex,width:c.width(),indexSibling:j.resizeData.siblingTarget.cellIndex,widthSibling:b.width()})}var j=this;j.resizeColData=null,j.resizePressed=!1,a.getTdTpl=function(a){return a.headerTpl&&""!==a.headerTpl?(a.headerTpl=a.headerTpl.replace("::field","c"),a.headerTpl):void 0},a.order=function(b){if(!j.resizePressed&&b.sortable){var c=a.getColConfig(b.fieldName);c.sortDirection=c.sortDirection==f.asc?f.desc:f.asc,a.setSortDirection(a.getColConfigIndex(b.fieldName),c.sortDirection),a.refreshDataGrid()}},j.resizeData={},a.resizeStart=function(b){var c=b.target?b.target:b.srcElement;if(c.classList.contains("resize")){j.resizeData.target=c.parentNode,j.resizeData.siblingTarget=c.parentNode.nextElementSibling;var d=$(j.resizeData.siblingTarget),e=$(j.resizeData.target);j.resizeData.resizePressed=!0,j.resizeData.startX=b.pageX,j.resizeData.startWidth=e.width(),j.resizeData.startWidthSibling=d.width(),j.resizeData.minWidth=50,j.resizeData.maxWidth=j.resizeData.startWidth+j.resizeData.startWidthSibling-j.resizeData.minWidth,document.addEventListener("mousemove",i),document.addEventListener("mouseup",a.resizeEnd),b.stopPropagation(),b.preventDefault()}},a.resizeEnd=function(b){return j.resizeData.resizePressed?(document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",a.resizeEnd),b.stopPropagation(),b.preventDefault(),null!==j.resizeColData&&(a.setColWidth(j.resizeColData.index,j.resizeColData.width),a.setColWidth(j.resizeColData.indexSibling,j.resizeColData.widthSibling),j.resizeColData=null),j.resizeData={},!1):void 0}}];return{priority:-20,require:["^?blsTable","blsHeader"],restrict:"E",link:g,controller:h}}]),angular.module("bls_components").directive("blsRowChild",["$log","$compile","$templateCache","$timeout",function(a,b,c,d){var e=function(a,e,f,g,h){var i=this;this.childs=[];var j=angular.element(c.get("templates/blsChildRowsCaret.html"));a.expand=!1,a.firstExpand=!0,this.getRowsChilds=function(a,b){var c=b.siblings('tr[parentId="'+a+'"]').toArray();i.childs=i.childs.concat(c);for(var d=0;d<c.length;d++)i.childs.concat(getRowsChilds(angular.element(c[d]).data("blsId"),$(c[d])));return i.childs};var k=angular.element(c.get("templates/blsChildRows.html"));angular.isDefined(f.level)||(a.level=0,e.data("dataLevel",a.level)),d(function(){this.toggle=function(a,b,c){i.childs=i.getRowsChilds(a,b),i.childs.forEach(function(a){c?$(a).show():$(a).hide()})},j.on("click",function(c){var d=$(this);if(a.firstExpand){j.addClass("fa-spinner"),a.firstExpand=!1;var f=a.$new();a.getChildren()(a.d).then(function(c){j.removeClass("fa-spinner"),c.data.length>0?(f.data=c.data,f.level=a.level+1,f.parentId=a.$id,b(k)(f),a.expand=!a.expand,i.toggle(a.$id,d.closest("tr"),a.expand),k.insertAfter(e)):j.removeClass("fa").removeClass("fa-caret-down").removeClass("fa-caret-right").off("click")})}else a.$apply(function(){a.expand=!a.expand,i.toggle(a.$id,d.closest("tr"),a.expand)})}),b(j)(a),angular.element(e.find("td")[0]).prepend(j)},0)};return{require:["^blsTable"],priority:-16,restrict:"A",link:e,scope:!0}}]),angular.module("bls_components").directive("blsRows",["$log","$compile","$templateCache","$timeout",function(a,b,c,d){var e=function(a,e,f,g){a.getTdTpl=function(a,b){return a.tpl&&""!==a.tpl?(a.tpl=a.tpl.replace("::row","d"),a.tpl):void 0};var h=angular.element(c.get("templates/blsRows.html"));a.isHierarchical()&&h.attr("bls-row-child",""),d(function(){e.siblings("table").find("tbody").append(h),b(h)(a)},0)};return{require:["^blsTable"],priority:-17,restrict:"E",link:e,scope:!0}}]),angular.module("bls_components").directive("blsSearchBox",[function(){var a=1;return{link:function(b,c,d){b.uniqueId="btn"+a++},scope:{ngModel:"=",options:"="},restrict:"E",templateUrl:"templates/blsSearchBox.html",replace:!0,controller:["$scope","$element","$log",function(a,b,c){var d={id:a.uniqueId,placeholder:"search...",minChars:3};if(this.initOptions=function(){var b=angular.copy(a.options);angular.merge(a.options,d),angular.merge(a.options,b)},a.refresh=function(){a.$emit("blsTable.RefreshEvent")},this.initOptions(),a.model=a.ngModel,0!==a.options.minChars){a.model=angular.copy(a.ngModel);var e=!1;a.$watch("model",function(b,c){(b!=c&&b.length>=a.options.minChars||e)&&(e=0!==b.length,a.ngModel=b)})}}]}}]),angular.module("bls_components").directive("blsSplitter",["$log","localStorageService",function(a,b){var c=["$scope","$log",function(a,c){a.regions=[],this.addRegion=function(d){var e=$(d);a.regions.push(e),c.debug(a.regions),e.resizable({handles:"e",minWidth:a.minWidth,maxWidth:a.maxWidth,create:function(c,d){var f={height:e.parent().height(),width:b.get("splitPageWitdh")||100},g=$(this);g.width(f.width),g.css("height","100%");var h=$(this).parent().width()-f.width,i=.06*$(this).parent().width();$.each(a.regions,function(b,c){e!==a.regions[b]&&a.regions[b].width(h-i+"px").css("height","100%")})},resize:function(c,d){var e=d.element.outerWidth();b.set("splitPageWitdh",e);var f=(d.element,$(this).parent().width()-e),g=.02999*$(this).parent().width();$.each(a.regions,function(b,c){a.regions[b].width(f-g+"px")})}})}}],d=function(a,b,c){$(b);$(window).resize(function(){}),$(window).trigger("resize")};return{transclude:!0,restrict:"E",link:d,controller:c,scope:{minWidth:"=",maxWidth:"="},template:'<div ng-transclude><div ng-repeat="r in regions"></div><div>'}}]).directive("blsSplitterRegion",["$log","localStorageService",function(a,b){var c=function(b,c,d,e){var f=e[0];a.debug("add new region"),f.addRegion(c)};return{transclude:!0,require:["^blsSplitter"],restrict:"E",link:c,replace:!0,template:'<div style="width:49%;height:500px;background-color:aliceblue;float:left;overflow-x:hidden;overflow-y:hidden" ng-transclude><div>'}}]),angular.module("bls_components").directive("blsStaticChildsRows",["$log","$compile","$templateCache","$timeout",function(a,b,c,d){var e=function(e,f,g,h,i){a.debug("    Link => blsStaticChildsRows");var j=this;e.childs=[];angular.element(c.get("templates/blsChildRowsCaret.html"));e.expand=!1,e.firstExpand=!0,e.isExpandable=!1;var k=h[0].getChildItemsProp();e.setChilds=function(b){e.childs=b[k],e.isExpandable=angular.isDefined(e.childs)&&e.childs.length,a.debug("scope.childs",e.childs)},e.cols=h[0].getCols(),e.getTdTpl=function(a,b){return a.tpl&&""!==a.tpl?(a.tpl=a.tpl.replace("::row","d"),a.tpl.replace("::field","d[c.fieldName]")):void 0};var l=angular.element(c.get("templates/blsStaticChildRows.html"));angular.isDefined(g.level)||(e.level=0,f.data("dataLevel",e.level)),d(function(){b(l)(e),f.siblings("table").find("tbody").append(l)}),this.toggle=function(a,b,c){j.childs=j.getRowsChilds(a,b),j.childs.forEach(function(a){c?$(a).show():$(a).hide()})}};return{require:["^blsTable"],priority:-16,restrict:"E",link:e,scope:{data:"=ngModel",level:"="}}}]).directive("blsStaticChildCells",["$log","$compile","$templateCache","$timeout",function(a,b,c,d){var e=function(e,f,g,h){a.debug("        Link => blsStaticChildData"),e.expand=!1;var i=angular.element(c.get("templates/blsStaticChildData.html"));e.childs=ngModel[childItemsProp],e.isExpandable=angular.isDefined(e.childs)&&e.childs.length,a.debug("scope.childs",e.childs),d(function(){b(i)(e),i.insertAfter(f)})};return{priority:-16,restrict:"E",link:e,scope:{ngModel:"=",level:"=",cols:"="}}}]),angular.module("bls_components").directive("blsToolBar",[function(){return{priority:2,scope:!0,restrict:"E",templateUrl:"templates/blsToolBar.html",replace:!0,controller:["$scope","$element","$log",function(a,b,c){a.btnClass="btn btn-default",a.searchPlaceHolder="search...",a.selectedAll=!1,a.titleExportButton="Export",a.clearUserData=function(){a.$emit("blsTable.ResetEvent")},a.refresh=function(){a.$emit("blsTable.RefreshEvent")},a.toggleSelectAll=function(){a.selectedAll=!a.selectedAll,a.$emit("blsTable.toggleSelectAllEvent",a.selectedAll)},a["export"]=function(b){c.debug("    export type => ",b),a.$emit("blsTable.ExportEvent",b)}}]}}]),angular.module("bls_components").directive("draggable",function(){return{link:function(a,b,c){b.attr("draggable",!0);var d="",e="";c.$observe("dragdata",function(a){d=a}),c.$observe("dragimage",function(a){e=a}),b.bind("dragstart",function(b){var e=angular.toJson(d);b.originalEvent.dataTransfer.setData("Text",e);var f=c.drag;"undefined"!==f&&a.$apply(function(){a[f](e)})})}}}),angular.module("bls_components").directive("droppable",["$parse",function(a){return{link:function(b,c,d){function e(a){return a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.originalEvent.dataTransfer.dropEffect="move",!1}function f(c){c.preventDefault&&c.preventDefault(),c.stopPropagation&&c.stopPropagation();var e=c.originalEvent.dataTransfer.getData("Text");e=angular.fromJson(e);var f=d.drop;a(d.drop);b.$apply(function(){b[f](e,c.target)})}c.bind("dragover",e),c.bind("drop",f)}}}]),angular.module("bls_components").directive("dynamic",["$compile","$log","$timeout",function(a,b,c){return{restrict:"A",replace:!0,priority:-20,link:function(b,d,e){c(function(){if(angular.isDefined(e.dynamic)){var c=b.$eval(e.dynamic);c&&""!==c&&(c=c.trim(),!c.startsWith("{{")&&$(c)[0]?d.html(c):d.text(c),a(d.contents())(b))}})}}}]),angular.module("bls_components").directive("panel",function(){return{link:function(a,b,c){a.dataSource="directive"},restrict:"E",scope:!0,template:function(){return angular.element(document.querySelector("#template")).html()},transclude:!0}}),angular.module("bls_components").factory("blsTableConfigManager",["$log","localStorageService",function(a,b){function c(a){this.storageKey=a,this.tableConfig={}}return c.prototype={get:function(){return this.tableConfig},init:function(a,c){if(b.isSupported&&(this.tableConfig=b.get(this.storageKey)),null!==this.tableConfig&&angular.isDefined(this.tableConfig.cols)&&this.tableConfig.cols.length!=a.length&&(this.tableConfig=null),null===this.tableConfig){this.tableConfig={id:this.storageKey,cols:[]};for(var d=Math.round(c/a.length),e=0;e<=a.length-1;e++)this.tableConfig.cols.push({index:e,fieldName:a[e].fieldName,width:d,sortDirection:"none"});this.save(this.tableConfig)}return this.tableConfig},saveItemsByPage:function(a){this.tableConfig.itemsByPage=a,this.save(this.tableConfig)},swapCol:function(a,b){this.tableConfig.cols.swap(a,b),this.save(this.tableConfig)},setSortDirection:function(a,b){this.tableConfig.cols[a].sortDirection=b,this.save(this.tableConfig)},setColWidth:function(a,b){return this.tableConfig.cols[a].width=b,this.save(this.tableConfig),this.tableConfig},listSortedCols:function(){var a=[];return this.tableConfig.cols.forEach(function(b){"none"!==b.sortDirection&&angular.isDefined(b.fieldName)&&a.push(b)}),a},save:function(a){b.isSupported&&b.set(this.storageKey,a)},destroy:function(){b.isSupported&&(a.debug("clear all regex => ","^(.)+"+this.storageKey+"$"),b.clearAll(this.storageKey+"$"))}},c}]),angular.module("bls_components").service("blsTableServices",["$log","localStorageService",function(a,b){Array.prototype.swap=function(a,b){if(a>=this.length)for(var c=a-this.length;c--+1;)this.push(void 0);return this.splice(a,0,this.splice(b,1)[0]),this},Array.prototype.distinct=function(){for(var a={},b=[],c=0,d=this.length;d>c;++c)a.hasOwnProperty(this[c])||(b.push(this[c]),a[this[c]]=1);return b},this.defaultColConfig=function(a){for(var b=new Array(a),c=b.length-1;c>=0;c--)b[c]=c;return b},this.swapArrayElements=function(a,b,c){var d=a[b];a[b]=a[c],a[c]=d},this.initReorderColumns=function(a,c,d){var e=b.get(d);(null===e||0===e.length)&&(e=this.defaultColConfig(a.length));for(var f=this,g=0;g<e.length-2;g++)if(g!=e[g]){if(g>e[g]&&g==e[e.indexOf(g)])continue;f.swapArrayElements(a,g,e.indexOf(g)),f.swapArrayElements(c,g,e.indexOf(g))}return e},this.saveConfig=function(c,d){b.isSupported&&(a.info("saveConfig  : "+d),a.info("saveConfig key : "+c),b.set(c,d))}}]).filter("highlight",["$sce",function(a){return function(b,c,d){return angular.isString(b)&&d?(c&&(b=b.replace(new RegExp("("+c+")","gi"),'<span class="highlighted">$1</span>')),a.trustAsHtml(b)):b}}]),function(a){a.fn.extend({tableExport:function(b){function c(a){return"true"==d.htmlContent?content_data=a.html().trim():content_data=a.text().trim(),"true"==d.escape&&(content_data=escape(content_data)),content_data}var d={separator:",",ignoreColumn:[],tableName:"yourTableName",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false"},b=a.extend(d,b),e=this;if("csv"==d.type||"txt"==d.type){var f="";a(e).find("thead").find("tr").each(function(){f+="\n",a(this).filter(":visible").find("th").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+='"'+c(a(this))+'"'+d.separator)}),f=a.trim(f),f=a.trim(f).substring(0,f.length-1)}),a(e).find("tbody").find("tr").each(function(){f+="\n",a(this).filter(":visible").find("td").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+='"'+c(a(this))+'"'+d.separator)}),f=a.trim(f).substring(0,f.length-1)}),"true"==d.consoleLog&&console.log(f);var g="base64,"+a.base64.encode(f);window.open("data:application/"+d.type+";filename=exportData;"+g)}else if("sql"==d.type){var f="INSERT INTO `"+d.tableName+"` (";a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+="`"+c(a(this))+"`,")}),f=a.trim(f),f=a.trim(f).substring(0,f.length-1)}),f+=") VALUES ",a(e).find("tbody").find("tr").each(function(){f+="(",a(this).filter(":visible").find("td").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+='"'+c(a(this))+'",')}),f=a.trim(f).substring(0,f.length-1),f+="),"}),f=a.trim(f).substring(0,f.length-1),f+=";","true"==d.consoleLog&&console.log(f);var g="base64,"+a.base64.encode(f);window.open("data:application/sql;filename=exportData;"+g)}else if("json"==d.type){var h=[];a(e).find("thead").find("tr").each(function(){var b=[];a(this).filter(":visible").find("th").each(function(e,f){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&b.push(c(a(this)))}),h.push(b)});var i=[];a(e).find("tbody").find("tr").each(function(){var b=[];a(this).filter(":visible").find("td").each(function(e,f){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&b.push(c(a(this)))}),i.push(b)});var j=[];j.push({header:h,data:i}),"true"==d.consoleLog&&console.log(JSON.stringify(j));var g="base64,"+a.base64.encode(JSON.stringify(j));window.open("data:application/json;filename=exportData;"+g)}else if("xml"==d.type){var k='<?xml version="1.0" encoding="utf-8"?>';k+="<tabledata><fields>",a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(k+="<field>"+c(a(this))+"</field>")})}),k+="</fields><data>";var l=1;a(e).find("tbody").find("tr").each(function(){k+='<row id="'+l+'">';var b=0;a(this).filter(":visible").find("td").each(function(e,f){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&(k+="<column-"+b+">"+c(a(this))+"</column-"+b+">"),b++}),l++,k+="</row>"}),k+="</data></tabledata>","true"==d.consoleLog&&console.log(k);var g="base64,"+a.base64.encode(k);window.open("data:application/xml;filename=exportData;"+g)}else if("excel"==d.type||"doc"==d.type||"powerpoint"==d.type){var m="<table>";a(e).find("thead").find("tr").each(function(){m+="<tr>",a(this).filter(":visible").find("th").each(function(b,e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(m+="<td>"+c(a(this))+"</td>")}),m+="</tr>"});var l=1;a(e).find("tbody").find("tr").each(function(){m+="<tr>";var b=0;a(this).filter(":visible").find("td").each(function(e,f){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&(m+="<td>"+c(a(this))+"</td>"),b++}),l++,m+="</tr>"}),m+="</table>","true"==d.consoleLog&&console.log(m);var n="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+d.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";n+="<head>",n+="<!--[if gte mso 9]>",n+="<xml>",n+="<x:ExcelWorkbook>",n+="<x:ExcelWorksheets>",n+="<x:ExcelWorksheet>",n+="<x:Name>",n+="{worksheet}",n+="</x:Name>",n+="<x:WorksheetOptions>",n+="<x:DisplayGridlines/>",n+="</x:WorksheetOptions>",n+="</x:ExcelWorksheet>",n+="</x:ExcelWorksheets>",n+="</x:ExcelWorkbook>",n+="</xml>",n+="<![endif]-->",n+="</head>",n+="<body>",n+=m,n+="</body>",n+="</html>";var g="base64,"+a.base64.encode(n);window.open("data:application/vnd.ms-"+d.type+";filename=exportData.doc;"+g)}else if("png"==d.type)html2canvas(a(e),{onrendered:function(a){var b=a.toDataURL("image/png");window.open(b)}});else if("pdf"==d.type){var o=new jsPDF("p","pt","a4",!0);o.setFontSize(d.pdfFontSize);var p=d.pdfLeftMargin;a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b,e){if("none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)){var f=p+50*b;o.text(f,20,c(a(this)))}})});var q=20,r=1,s=0;a(e).find("tbody").find("tr").each(function(b,e){rowCalc=b+1,rowCalc%26==0&&(o.addPage(),r++,q+=10),s=q+10*rowCalc-280*(r-1),a(this).filter(":visible").find("td").each(function(b,e){if("none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)){var f=p+50*b;o.text(f,s,c(a(this)))}})}),o.output("datauri")}}})}(jQuery),jQuery.base64=function(a){function b(a,b){var c=g.indexOf(a.charAt(b));if(-1===c)throw"Cannot decode base64";return c}function c(a){var c,d,e=0,g=a.length,h=[];if(a=String(a),0===g)return a;
if(g%4!==0)throw"Cannot decode base64";for(a.charAt(g-1)===f&&(e=1,a.charAt(g-2)===f&&(e=2),g-=4),c=0;g>c;c+=4)d=b(a,c)<<18|b(a,c+1)<<12|b(a,c+2)<<6|b(a,c+3),h.push(String.fromCharCode(d>>16,d>>8&255,255&d));switch(e){case 1:d=b(a,c)<<18|b(a,c+1)<<12|b(a,c+2)<<6,h.push(String.fromCharCode(d>>16,d>>8&255));break;case 2:d=b(a,c)<<18|b(a,c+1)<<12,h.push(String.fromCharCode(d>>16))}return h.join("")}function d(a,b){var c=a.charCodeAt(b);if(c>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return c}function e(a){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";a=String(a);var b,c,e=[],h=a.length-a.length%3;if(0===a.length)return a;for(b=0;h>b;b+=3)c=d(a,b)<<16|d(a,b+1)<<8|d(a,b+2),e.push(g.charAt(c>>18)),e.push(g.charAt(c>>12&63)),e.push(g.charAt(c>>6&63)),e.push(g.charAt(63&c));switch(a.length-h){case 1:c=d(a,b)<<16,e.push(g.charAt(c>>18)+g.charAt(c>>12&63)+f+f);break;case 2:c=d(a,b)<<16|d(a,b+1)<<8,e.push(g.charAt(c>>18)+g.charAt(c>>12&63)+g.charAt(c>>6&63)+f)}return e.join("")}var f="=",g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="1.0";return{decode:c,encode:e,VERSION:h}}(jQuery);
//# sourceMappingURL=blsComponents.min.js.map